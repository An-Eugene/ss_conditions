<html>
  <head>
    <title>Download for iPhone</title>
  </head>
  <style>
    html, body {margin:0;padding:0;}
    body {
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      background-color: #1a1919;
      min-height:100vh;
    }
    .download_button {
      color: #f18550;
      font-size:1.5rem;
      font-weight:bold;
      background-color: #363434;
      padding:2rem;
      border-radius:1.5rem;
    }
  </style>
  <body>
    <!--<a class="download_button" href="https://raw.githubusercontent.com/An-Eugene/ss_conditions/main/ss_conditions.conf" download="ss.conf">Нажмите, чтобы скачать файл</a>--> 
    <a class="download_button" id="downloadLink" href="#" onclick="downloadModifiedFile()">Download config file</a>
  <script>
    function downloadModifiedFile() {
      var originalFileUrl = "https://raw.githubusercontent.com/An-Eugene/ss_conditions/main/ss_conditions_shadowlink.conf";
      var modifiedFileName = "ss_conditions.conf";

      fetch(originalFileUrl)
        .then(response => response.text())
        .then(fileContent => {
          var modifiedContent = fileContent;
          var blob = new Blob([modifiedContent], { type: 'text/plain' });
          var url = URL.createObjectURL(blob);

          var downloadLink = document.getElementById("downloadLink");
          downloadLink.href = url;
          downloadLink.download = modifiedFileName;

          // Remove the onclick attribute
          return new Promise(resolve => {
            setTimeout(() => {
              downloadLink.removeAttribute("onclick");
              resolve();
            }, 0);
          });
        })
        .then(() => {
          // Programmatically trigger the click event
          var downloadLink = document.getElementById("downloadLink");
          downloadLink.click();
        })
        .catch(error => {
          console.error('Error:', error);
        });
    }
  </script>
  </body>
</html>
